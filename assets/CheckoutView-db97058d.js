import{_ as v,o as i,c as l,b as t,F as w,l as C,t as r,n as k,q as T,j as I,m as V,a as E,r as b,d as g,w as L,e as O}from"./index-fc1b60a1.js";import{c as y}from"./cartStore-ae31ee09.js";import{T as u}from"./Toast-2c11397b.js";import"./statusStore-aef80293.js";const{VITE_API:x,VITE_PATH:$}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"coffee11",BASE_URL:"/cafe_backend/",MODE:"production",DEV:!1,PROD:!0},P={data(){return{order:{products:[],user:{}},orderId:"",isLoading:!1,isProcessing:!1}},methods:{getOrder(){this.isLoading=!0,this.$http.get(`${x}/api/${$}/order/${this.orderId}`).then(e=>{this.isLoading=!1;const{order:d}=e.data;this.order=d}).catch(e=>{var n,c;const d=((c=(n=e.response)==null?void 0:n.data)==null?void 0:c.message)||"資料錯誤";this.isLoading=!1,u.fire({title:`${d}`,icon:"error"})})},payOrder(){this.isLoading=!0,this.$http.post(`${x}/api/${$}/pay/${this.orderId}`).then(()=>{this.isLoading=!1,this.getOrder(),u.fire({title:"付款成功",icon:"success"})}).catch(e=>{var n,c;const d=((c=(n=e.response)==null?void 0:n.data)==null?void 0:c.message)||"資料錯誤";this.isLoading=!1,u.fire({title:`${d}`,icon:"error"})})}},mounted(){this.orderId=this.$route.params.orderId,this.getOrder()}},A={class:"col-md-6"},N={class:"card rounded-0 py-4 mb-3"},j=t("div",{class:"card-header border-bottom-0 bg-white px-4 py-0"},[t("h2",null,"Order Detail")],-1),D={class:"card-body px-4 py-0"},S={class:"list-group list-group-flush"},B={class:"d-flex mt-2"},M=["src","alt"],q={class:"w-100 d-flex flex-column"},F={class:"d-flex justify-content-between fw-bold"},H={class:"mb-0"},R={class:"d-flex justify-content-between mt-auto"},U={class:"text-muted mb-0"},z={class:"mb-0"},G={class:"list-group-item px-0 pb-0"},J=t("table",{class:"table text-muted"},[t("tbody",null,[t("tr",null,[t("th",{scope:"row",class:"border-0 px-0 pt-0 font-weight-normal"}," Payment "),t("td",{class:"text-end border-0 px-0 pt-0"},"ApplePay")])])],-1),K={class:"d-flex justify-content-between mt-2"},Q=t("p",{class:"mb-0 h4 fw-bold"},"總計",-1),W={class:"mb-0 h4 fw-bold"},X={class:"card rounded-0 py-4"},Y={class:"table"},Z=t("th",{width:"100"},"Email",-1),tt=t("th",null,"姓名",-1),st=t("th",null,"收件人電話",-1),et=t("th",null,"收件人地址",-1),ot=t("th",null,"付款狀態",-1),rt={key:0,class:"text-end mt-4"},dt=t("button",{type:"submit",class:"btn btn-primary"},"確認付款去",-1),nt=[dt];function ct(e,d,n,c,o,_){return i(),l("div",A,[t("form",{onSubmit:d[0]||(d[0]=I((...s)=>_.payOrder&&_.payOrder(...s),["prevent"]))},[t("div",N,[j,t("div",D,[t("ul",S,[(i(!0),l(w,null,C(o.order.products,s=>{var a,h,p,m,f;return i(),l("li",{key:s.id,class:"list-group-item px-0"},[t("div",B,[t("img",{src:(a=s.product)==null?void 0:a.imageUrl,alt:(h=s.product)==null?void 0:h.title,class:"me-2",style:{width:"60px",height:"60px","object-fit":"cover"}},null,8,M),t("div",q,[t("div",F,[t("h5",null,r((p=s.product)==null?void 0:p.title),1),t("p",H,"x"+r(s.qty),1)]),t("div",R,[t("p",U,[t("small",null," NT$"+r(e.$filters.currency((m=s.product)==null?void 0:m.price)),1)]),t("p",z," NT$"+r(e.$filters.currency((f=s.product)==null?void 0:f.price)),1)])])])])}),128)),t("li",G,[J,t("div",K,[Q,t("p",W," NT$"+r(e.$filters.currency(o.order.total)),1)])])])])]),t("div",X,[t("table",Y,[t("tbody",null,[t("tr",null,[Z,t("td",null,r(o.order.user.email),1)]),t("tr",null,[tt,t("td",null,r(o.order.user.name),1)]),t("tr",null,[st,t("td",null,r(o.order.user.tel),1)]),t("tr",null,[et,t("td",null,r(o.order.user.address),1)]),t("tr",null,[ot,t("td",null,[t("span",{class:k({"text-success":o.order.is_paid})},r(o.order.is_paid?"付款完成":"尚未付款"),3)])])])])]),o.order.is_paid===!1?(i(),l("div",rt,nt)):T("",!0)],32)])}const it=v(P,[["render",ct]]),lt={data(){return{}},components:{CheckoutCard:it},methods:{...V(y,["getCarts"])},computed:{...E(y,["cart"])},mounted(){this.getCarts()}},at={class:"container my-5"},_t={class:"row"},ut={class:"col-md-6"},ht=t("h2",null,"訂單完成",-1),pt=t("p",null,"感謝訂購",-1);function mt(e,d,n,c,o,_){const s=b("router-link"),a=b("CheckoutCard");return i(),l("div",at,[t("div",_t,[t("div",ut,[ht,pt,g(s,{to:"/",class:"btn btn-outline-dark me-2 rounded-0 mb-4"},{default:L(()=>[O(" 回首頁 ")]),_:1})]),g(a)])])}const xt=v(lt,[["render",mt]]);export{xt as default};
